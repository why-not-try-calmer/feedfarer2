version: "3"
services:
    feedfarer:
        depends_on: [redis]
        restart: "no"
        build: .
        command: stack test
        ports: [80:80]
        environment:
         - TELEGRAM_TOKEN=${env.TELEGRAM_TOKEN}
         - BASE_URL=${env.BASE_URL}
         - ALERT_CHATID=${env.ALERT_CHATID}
         - WEBHOOK_URL=${env.WEBHOOK_URL}
         - MONGO_CONN_STRING=${env.MONGO_CONN_STRING}
    redis:
        image: redis:latest
        ports: [6379:6379]
        restart: unless-stopped
        volumes:
          - /data/redis-store
