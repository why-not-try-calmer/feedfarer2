FROM haskell:9.0.2
RUN stack upgrade
WORKDIR /opt/app

COPY . /opt/app/
RUN stack --resolver lts-19.33 test \
  --fast \
  --no-run-tests \
  --no-library-profiling \
  --system-ghc \
  --no-install-ghc
  
COPY /static /var/www/feedfarer-webui
CMD ["stack", "test", "--fast"]
